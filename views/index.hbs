<head>
	<link rel="stylesheet" type="text/css" href="/css/main.css">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>

<div id="example"></div>

<div class="fr-view">
  Here comes the HTML edited with the Froala rich text editor.
</div>

<div class="row" style="margin-top: 15px;">

    <div class="col-md-9">
        <div class="show-team">
            <div class="table-type-1"  style="margin-right: 0px;">
                <div class="blogs">

                </div>
            </div>
        </div>
    </div>

    <div class="col-md-3">
        <div class="table-type-1" style="margin-left: 0px;">
            <div class="table-title-2">
                <h6 style="text-align: center;"><b>Top Rated [<a style="color: rgb(109, 164, 209);" href = "/user/leaderboard/">view all</a>]</b></h6>
            </div>
            <table id="topRatedMemberTable" class="table table-striped table-bordered" style="text-align: center;">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>User</th>
                        <th>Skill</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>
        <div class="table-type-1" style="margin-left: 0px;">
            <div class="table-title-2">
                <h6 style="text-align: center;"><b>Top Solvers [<a style="color: rgb(109, 164, 209);" href = "/user/leaderboard/">view all</a>]</b></h6>
            </div>
            <table id="topSolverMemberTable" class="table table-striped table-bordered" style="text-align: center;">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>User</th>
                        <th>Solve Count</th>
                    </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </div>
        <div class="table-type-1" style="margin-left: 0px; padding:0px;">
            <div id="donutchart" style="margin:0px; padding:0px; height: 350px;"></div>
        </div>
    </div>
</div>


<script type="text/javascript">

    function viewBlogInBlogs(){
        var blog_para_max_length = 1000
        var db_list = [];
        {{#each blog_list}}
            var blog_text = `{{blog_text}}`
            if(blog_text.length > blog_para_max_length){
                blog_text = blog_text.substring(0, blog_para_max_length)
                blog_text += ' . . .'
            }

            var html = `
                <div class="blog-post-1">
                <div class="post-header">
                    <a href="/blog/post/view/{{blog_id}}/"><h2 style="color: rgb(23, 81, 104);" class="media-heading"><b>{{blog_title}}</b></h2></a>
                </div>
                <div class="post-sub-header">
                    <p class="text-left"> <b><span style="color: rgb(214, 193, 7); padding-right:3px;">{{blog_writer_handle}}</span>, <span style="color: #95989B; padding-left:7px;"> {{updated_at}}</span></b></p>
                </div>
                <div class="post-body">
                    <p> ${blog_text} </p>
                </div>
                <div class="post-read-more">
                    <a href="/blog/post/view/{{blog_id}}/"><p style="color: rgb(23, 81, 104);" class="media-heading"><b>READ MORE <i style="height: 11px;" class="fas fa-angle-double-right"></i></b></p></a>
                </div>
                <div class="post-footer">
                    <p class="text-left"> Blog Topic : <b><span style="color: rgb(123, 137, 150); padding-right:3px;">{{blog_topic}}</span></b></p>
                </div>
                <hr>
                <div class="row post-foter">
                    <div class="col-md-10">
                        <a href="/vote/like/{{blog_id}}/"><span style="padding-right: 20px; color: rgb(31, 192, 57);"><i class="fas fa-thumbs-up"></i> {{vote_count.like_count}}</span></a>
                        <a href="/vote/dislike/{{blog_id}}/"><span style="color: rgb(209, 84, 0);"><i class="fas fa-thumbs-down"></i> {{vote_count.dislike_count}}</span></a>
                    </div>
                    <div class="col-md-2">
                        <a href="/blog/post/view/{{blog_id}}/"><span style="color: rgb(19, 87, 104);"><i class="fas fa-comment"></i> {{comment_count}} Comments</span></a>
                    </div>
                </div>
            </div>
            `
            $(".blogs").append(html);
        {{/each}}
        return db_list;
    }


    function getTopRatedList(){
        var dt_list = [];
        {{#each top_rated_users}}
            var user_link = '<a href = "/profile/{{username}}/" style="color: #5bc0de; font-weight:700;">{{username}}</a>'
            var data = ["{{rank}}", user_link, "{{skill_value}}"];
            dt_list.push(data)
        {{/each}}

        return dt_list;
    }

    function getTopSolverList(){
        var dt_list = [];
        {{#each top_solved_users}}
            var user_link = '<a href = "/profile/{{username}}/" style="color: #5bc0de; font-weight:700;">{{username}}</a>'
            var data = ["{{rank}}", user_link, "{{solve_count}}"];
            dt_list.push(data)
        {{/each}}

        return dt_list;
    }

    function showTopRatedMemberDTSearchTable(){
        var dt_list = getTopRatedList();
        
        $("#topRatedMemberTable").dataTable({
            "aaData": dt_list,
            paging: false,
            destroy: true,
            searching: false,
            ordering:  false,
            scrollCollapse: true,
            responsive: true,
            pageLength: 10
        });
    }

    function showTopSolverMemberDTSearchTable(){
        var dt_list = getTopSolverList();
        
        $("#topSolverMemberTable").dataTable({
            "aaData": dt_list,
            paging: false,
            destroy: true,
            searching: false,
            ordering:  false,
            scrollCollapse: true,
            responsive: true,
            pageLength: 10
        });
    }

    google.charts.load("current", {packages:["corechart"]});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
          ['Topic', 'Percentage'],
          ['DP',     120],
          ['Graph',      22],
          ['Base',  57],
          ['DS', 55],
          ['NT',    32],
          ['Combinatorics',    11],
          ['Math',    45],
          ['Geometry',    0]
        ]);

        var options = {
          title: 'Problem Statistics',
          pieHole: 0.3
        };

        var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
        chart.draw(data, options);
      }

    $(document).ready( function () {
        viewBlogInBlogs();
        showTopRatedMemberDTSearchTable();
        showTopSolverMemberDTSearchTable();
        var editor = new FroalaEditor('#example')
    } );

</script>
